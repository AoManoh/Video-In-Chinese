# Video-In-Chinese

AI é©±åŠ¨çš„è§†é¢‘ç¿»è¯‘å’Œé…éŸ³ç³»ç»Ÿ

---

## å¿«é€Ÿå¼€å§‹

### æ–°åŒäº‹å…¥é—¨

å¦‚æžœæ‚¨æ˜¯ç¬¬ä¸€æ¬¡æŽ¥è§¦æœ¬é¡¹ç›®ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

1. **é˜…è¯»å¿«é€Ÿå¯åŠ¨å‚è€ƒå¡** â­ æŽ¨è
   - ðŸ“„ [docs/QUICK_START_REFERENCE.md](docs/QUICK_START_REFERENCE.md)
   - æœ€ç²¾ç®€çš„å¯åŠ¨æŒ‡å—ï¼Œ5-10 åˆ†é’Ÿå³å¯ä¸Šæ‰‹

2. **å¯åŠ¨é¡¹ç›®**
   - æŒ‰ç…§å¿«é€Ÿå‚è€ƒå¡ä¸­çš„æ­¥éª¤å¯åŠ¨ 4 ä¸ªåŽç«¯æœåŠ¡
   - é€šè¿‡å‰ç«¯ç•Œé¢é…ç½® AI æœåŠ¡å•†

3. **é‡åˆ°é—®é¢˜ï¼Ÿ**
   - ðŸ“„ [docs/TROUBLESHOOTING_GUIDE.md](docs/TROUBLESHOOTING_GUIDE.md)
   - åŒ…å«å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

### æ–‡æ¡£å¯¼èˆª

| æ–‡æ¡£ | é€‚ç”¨åœºæ™¯ | é˜…è¯»æ—¶é—´ |
|------|---------|---------|
| [å¿«é€Ÿå¯åŠ¨å‚è€ƒå¡](docs/QUICK_START_REFERENCE.md) | æ—¥å¸¸å¯åŠ¨ã€å¿«é€ŸæŸ¥é˜… | 5-10 åˆ†é’Ÿ |
| [é¡¹ç›®å¯åŠ¨æŒ‡å—](docs/PROJECT_STARTUP_GUIDE.md) | é¦–æ¬¡å¯åŠ¨ã€æ·±å…¥äº†è§£ | 15-20 åˆ†é’Ÿ |
| [AudioSeparatoræœåŠ¡è¯´æ˜Ž](docs/AudioSeparatoræœåŠ¡è¯´æ˜Ž.md) | éŸ³é¢‘åˆ†ç¦»æœåŠ¡ï¼ˆDemucsï¼‰ | 10 åˆ†é’Ÿ |
| [è™šæ‹ŸçŽ¯å¢ƒå­è¿›ç¨‹åˆ†æž](docs/VENV_SUBPROCESS_ANALYSIS.md) | Windows venv å¹½çµè¿›ç¨‹ çŽ°è±¡ | 10 åˆ†é’Ÿ |
| [æ•…éšœæŽ’æŸ¥æŒ‡å—](docs/TROUBLESHOOTING_GUIDE.md) | é‡åˆ°é”™è¯¯ã€æ€§èƒ½é—®é¢˜ | 20-30 åˆ†é’Ÿ |
| [SpleeteréŸ³é¢‘åˆ†ç¦»å¤±è´¥é—®é¢˜è¯Šæ–­æŠ¥å‘Š](docs/SpleeteréŸ³é¢‘åˆ†ç¦»å¤±è´¥é—®é¢˜è¯Šæ–­æŠ¥å‘Š.md) | éŸ³é¢‘åˆ†ç¦»å¤±æ•ˆ | 15 åˆ†é’Ÿ |
| [DemucsæŠ€æœ¯å‡çº§æ–¹æ¡ˆè¯„ä¼°](docs/DemucsæŠ€æœ¯å‡çº§æ–¹æ¡ˆè¯„ä¼°.md) | æŠ€æœ¯å‡çº§è¯„ä¼° | 20 åˆ†é’Ÿ |
| [å»ºè®®è¯„ä¼°æŠ¥å‘Š](docs/å»ºè®®è¯„ä¼°æŠ¥å‘Š.md) | æŠ€æœ¯å»ºè®®å‡†ç¡®æ€§è¯„ä¼° | 10 åˆ†é’Ÿ |
| [æ–‡æ¡£ä¸­å¿ƒ](docs/README.md) | æŸ¥æ‰¾ç‰¹å®šæ–‡æ¡£ | - |

### åŠŸèƒ½ç‰¹æ€§

- ðŸŽ¬ è§†é¢‘ä¸Šä¼ å’Œå¤„ç†
- ðŸŽ™ï¸ éŸ³é¢‘åˆ†ç¦»å’Œè¯­éŸ³è¯†åˆ«ï¼ˆASRï¼‰
- ðŸŒ å¤šè¯­è¨€ç¿»è¯‘
- âœ¨ AI é©±åŠ¨çš„è¯‘æ–‡ä¼˜åŒ–
- ðŸ—£ï¸ å£°éŸ³å…‹éš†å’Œé…éŸ³
- ðŸ”„ é‡è¯•å’Œé™çº§æœºåˆ¶

### æŠ€æœ¯æ ˆ

**åŽç«¯**:
- Go 1.21+
- Go-Zero æ¡†æž¶
- gRPC é€šä¿¡
- Redis å­˜å‚¨
- Python 3.11 (AudioSeparator)
- PyTorch 2.9+ (Demucs å¼•æ“Ž)

**å‰ç«¯**:
- (æ ¹æ®å®žé™…æƒ…å†µå¡«å†™)

**åŸºç¡€è®¾æ–½**:
- Docker (Redis)
- é˜¿é‡Œäº‘ OSS (å¯é€‰)

### ç³»ç»Ÿæž¶æž„

```
å‰ç«¯ (5173)
    â†“ HTTP
Gateway (8080) â† API ç½‘å…³ã€é…ç½®ç®¡ç†
    â†“ gRPC
Task Service (50050) â† ä»»åŠ¡ç®¡ç†
    â†“ gRPC
Processor â† ä»»åŠ¡ç¼–æŽ’
    â”œâ”€ gRPC â†’ AudioSeparator (50052) â† éŸ³é¢‘åˆ†ç¦» (Demucs)
    â””â”€ gRPC â†’ AI Adaptor (50053) â† AI æœåŠ¡é€‚é…å™¨
    â†“ HTTP/gRPC
å¤–éƒ¨ AI æœåŠ¡ (ASR, ç¿»è¯‘, å£°éŸ³å…‹éš†)
```

---

## å¿«é€Ÿå¯åŠ¨

### å‰ç½®æ¡ä»¶

- Go 1.21+
- Node.js 18+
- Docker Desktop
- PowerShell

### å¯åŠ¨æ­¥éª¤ï¼ˆç®€åŒ–ç‰ˆï¼‰

1. **å¯åŠ¨ Redis**
```powershell
docker start redis-test
```

2. **æ¸…ç©ºé…ç½®ç¼“å­˜**
```powershell
docker exec redis-test redis-cli DEL app:settings
```

3. **å¯åŠ¨åŽç«¯æœåŠ¡**ï¼ˆ5 ä¸ªç‹¬ç«‹ç»ˆç«¯ï¼ŒæŒ‰é¡ºåºå¯åŠ¨ï¼‰

ç»ˆç«¯ 1 - Task Service:
```powershell
cd server/mcp/task
go run . -f etc/task.yaml
```

ç»ˆç«¯ 2 - AudioSeparator (å¯é€‰ä½†æŽ¨è):
```powershell
cd server/mcp/audio_separator
D:\Go-Project\video-In-Chinese\server\.venv\Scripts\python.exe main.py
```

ç»ˆç«¯ 3 - AI Adaptor:
```powershell
cd server/mcp/ai_adaptor
# è®¾ç½®çŽ¯å¢ƒå˜é‡ï¼ˆè§å¿«é€Ÿå‚è€ƒå¡ï¼‰
go run . -f etc/ai_adaptor.yaml
```

ç»ˆç«¯ 4 - Processor:
```powershell
cd server/mcp/processor
go run . -f etc/processor.yaml
```

ç»ˆç«¯ 5 - Gateway:
```powershell
cd server/app/gateway
go run . -f etc/gateway-api.yaml
```

4. **é…ç½®å‰ç«¯**
   - è®¿é—® `http://localhost:5173`
   - è¿›å…¥è®¾ç½®é¡µé¢
   - å¡«å†™ AI æœåŠ¡å•†é…ç½®
   - ä¿å­˜é…ç½®

**è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒ**: [docs/QUICK_START_REFERENCE.md](docs/QUICK_START_REFERENCE.md)

---

## å¸¸è§é—®é¢˜

### Q: å¯åŠ¨æ—¶æç¤ºç«¯å£è¢«å ç”¨ï¼Ÿ

**A**: æ£€æŸ¥å¹¶ç»ˆæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
```powershell
netstat -ano | findstr :50050
taskkill /F /PID [è¿›ç¨‹ID]
```

### Q: Redis è¿žæŽ¥å¤±è´¥ï¼Ÿ

**A**: ç¡®ä¿ AI Adaptor è®¾ç½®äº†æ­£ç¡®çš„çŽ¯å¢ƒå˜é‡
```powershell
$env:REDIS_HOST="127.0.0.1"
```

### Q: ä¸­æ–‡æ˜¾ç¤ºä¹±ç ï¼Ÿ

**A**: åœ¨æ¯ä¸ªç»ˆç«¯å¯åŠ¨å‰è®¾ç½® UTF-8
```powershell
[Console]::InputEncoding = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
```

**æ›´å¤šé—®é¢˜**: [docs/TROUBLESHOOTING_GUIDE.md](docs/TROUBLESHOOTING_GUIDE.md)

---

## é¡¹ç›®ç»“æž„

```
video-In-Chinese/
â”œâ”€â”€ server/                 # åŽç«¯æœåŠ¡
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â””â”€â”€ gateway/       # API ç½‘å…³ (8080)
â”‚   â””â”€â”€ mcp/
â”‚       â”œâ”€â”€ task/          # ä»»åŠ¡æœåŠ¡ (50050)
â”‚       â”œâ”€â”€ ai_adaptor/    # AI é€‚é…å™¨ (50053)
â”‚       â””â”€â”€ processor/     # å¤„ç†å™¨
â”œâ”€â”€ client/                # å‰ç«¯åº”ç”¨
â”œâ”€â”€ docs/                  # é¡¹ç›®æ–‡æ¡£ â­
â”‚   â”œâ”€â”€ README.md         # æ–‡æ¡£ä¸­å¿ƒ
â”‚   â”œâ”€â”€ QUICK_START_REFERENCE.md  # å¿«é€Ÿå‚è€ƒ
â”‚   â”œâ”€â”€ PROJECT_STARTUP_GUIDE.md  # å¯åŠ¨æŒ‡å—
â”‚   â””â”€â”€ TROUBLESHOOTING_GUIDE.md  # æ•…éšœæŽ’æŸ¥
â”œâ”€â”€ data/                  # æ•°æ®ç›®å½•
â””â”€â”€ README.md             # æœ¬æ–‡ä»¶
```

---

## å¼€å‘æŒ‡å—

### çŽ¯å¢ƒå˜é‡

AI Adaptor éœ€è¦ä»¥ä¸‹çŽ¯å¢ƒå˜é‡ï¼š

```powershell
# Redis é…ç½®
$env:REDIS_HOST="127.0.0.1"
$env:REDIS_PORT="6379"
$env:REDIS_PASSWORD=""
$env:REDIS_DB="0"

# åŠ å¯†å¯†é’¥
$env:API_KEY_ENCRYPTION_SECRET="YOUR_ENCRYPTION_SECRET"

# é˜¿é‡Œäº‘ OSSï¼ˆå¯é€‰ï¼‰
$env:ALIYUN_OSS_ACCESS_KEY_ID="..."
$env:ALIYUN_OSS_ACCESS_KEY_SECRET="..."
$env:ALIYUN_OSS_BUCKET_NAME="..."
$env:ALIYUN_OSS_ENDPOINT="..."
```

### é…ç½®æ–‡ä»¶

| æœåŠ¡ | é…ç½®æ–‡ä»¶ |
|------|---------|
| Gateway | `server/app/gateway/etc/gateway-api.yaml` |
| Task Service | `server/mcp/task/etc/task.yaml` |
| AI Adaptor | `server/mcp/ai_adaptor/etc/ai_adaptor.yaml` |
| Processor | `server/mcp/processor/etc/processor.yaml` |

### æœåŠ¡ç«¯å£

| æœåŠ¡ | ç«¯å£ | åè®® |
|------|------|------|
| Gateway | 8080 | HTTP |
| Task Service | 50050 | gRPC |
| AudioSeparator | 50052 | gRPC |
| AI Adaptor | 50053 | gRPC |
| Processor | - | å†…éƒ¨ |

---

## æµ‹è¯•

### å¥åº·æ£€æŸ¥

```powershell
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡
tasklist | findstr "task.exe ai_adaptor.exe gateway.exe processor.exe"

# æ£€æŸ¥ç«¯å£
netstat -ano | findstr "50050 50053 8080"

# æµ‹è¯• Gateway API
Invoke-WebRequest -Uri "http://localhost:8080/v1/settings" -Method GET
```

### ç«¯åˆ°ç«¯æµ‹è¯•

1. ä¸Šä¼ è§†é¢‘æ–‡ä»¶
2. è§‚å¯Ÿä»»åŠ¡çŠ¶æ€å˜åŒ–
3. æ£€æŸ¥å„å¤„ç†æ­¥éª¤ï¼š
   - éŸ³é¢‘åˆ†ç¦»
   - ASR è¯­éŸ³è¯†åˆ«
   - ç¿»è¯‘
   - è¯‘æ–‡ä¼˜åŒ–
   - å£°éŸ³å…‹éš†

---

## è´¡çŒ®æŒ‡å—

### ä»£ç è§„èŒƒ

- Go ä»£ç éµå¾ª Go å®˜æ–¹è§„èŒƒ
- æäº¤å‰è¿è¡Œ `go fmt`
- æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£

### æ–‡æ¡£æ›´æ–°

- é…ç½®å˜æ›´å¿…é¡»åŒæ­¥æ›´æ–°æ–‡æ¡£
- æ–°çš„æ•…éšœæ¡ˆä¾‹æ·»åŠ åˆ°æ•…éšœæŽ’æŸ¥æŒ‡å—
- æ›´æ–°æ–‡æ¡£åŽä¿®æ”¹æ—¶é—´æˆ³

---

## è®¸å¯è¯

(æ ¹æ®å®žé™…æƒ…å†µå¡«å†™)

---

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚

---

**æç¤º**: 
- æ–°åŒäº‹è¯·å…ˆé˜…è¯» [docs/QUICK_START_REFERENCE.md](docs/QUICK_START_REFERENCE.md)
- é‡åˆ°é—®é¢˜è¯·æŸ¥é˜… [docs/TROUBLESHOOTING_GUIDE.md](docs/TROUBLESHOOTING_GUIDE.md)
- æ‰€æœ‰æ–‡æ¡£ç´¢å¼•è¯·è®¿é—® [docs/README.md](docs/README.md)

---

# å¯åŠ¨è¡¥å……

> å¾ˆå¤šå‘˜å·¥å­˜åœ¨å¯åŠ¨å¤±è´¥é—®é¢˜ï¼Œé’ˆå¯¹æ­¤ç±»é—®é¢˜ã€‚ä¸‹é¢æä¾›ä¸€ä¸ªæ˜Žç¡®èƒ½æ­£ç¡®å¯åŠ¨æœåŠ¡çš„æ¡ˆä¾‹ï¼Œæ³¨æ„ï¼Œå½“å‰å¯åŠ¨æµç¨‹é»˜è®¤ä½ å·²ç»å®Œå…¨æŒ‰ç…§è¦æ±‚ï¼Œå¯åŠ¨äº†å‰ç½® docker ä¾èµ–æœåŠ¡ã€‚å¦‚æžœå¹¶æœªå¯åŠ¨ï¼Œè¯·ç«‹åˆ»æ ¹æ®æ–‡æ¡£ï¼Œæ£€æŸ¥dockeræœåŠ¡çŠ¶æ€

é¦–å…ˆå¯åŠ¨ Task Serviceï¼š

```cmd
powershell -NoProfile -Command "[Console]::InputEncoding = [Text.UTF8Encoding]::new(`$false); [Console]::OutputEncoding = [Text.UTF8Encoding]::new(`$false); chcp 65001 > `$null; cd 'D:\Go-Project\video-In-Chinese\server\mcp\task'; go run . -f etc/task.yaml"
```

å¯åŠ¨ AI Adaptorï¼š

```cmd
æ‰§è¡ŒPowerShellå‘½ä»¤ï¼ŒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š
# 1. è®¾ç½®UTF-8å’Œchcp
[Console]::InputEncoding = [Text.UTF8Encoding]::new($false)
[Console]::OutputEncoding = [Text.UTF8Encoding]::new($false)
chcp 65001 > $null
# 2. æ­£ç¡®åŠ è½½ server/.env æ–‡ä»¶ä¸­çš„OSSåŠç§˜é’¥å˜é‡
```

å¯åŠ¨ Gatewayï¼š

```cmd
powershell -NoProfile -Command "[Console]::InputEncoding = [Text.UTF8Encoding]::new(`$false); [Console]::OutputEncoding = [Text.UTF8Encoding]::new(`$false); chcp 65001 > `$null; cd 'D:\Go-Project\video-In-Chinese\server\app\gateway'; go run . -f etc/gateway-api.yaml"
```

å¯åŠ¨ Processorï¼š

```cmd
powershell -NoProfile -Command "[Console]::InputEncoding = [Text.UTF8Encoding]::new(`$false); [Console]::OutputEncoding = [Text.UTF8Encoding]::new(`$false); chcp 65001 > `$null; cd 'D:\Go-Project\video-In-Chinese\server\mcp\processor'; go run . -f etc/processor.yaml"
```



